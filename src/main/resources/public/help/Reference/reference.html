


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Reference Guide &mdash; Notion: a PACS for researchers 1.0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="Notion: a PACS for researchers 1.0 documentation" href="../index.html"/>
        <link rel="next" title="Development" href="../Development/development.html"/>
        <link rel="prev" title="Use Cases" href="../GettingStarted/use_cases.html"/>
<link rel="stylesheet" href="../_static/notion.css" />
<link href='http://fonts.googleapis.com/css?family=Source+Code+Pro' rel='stylesheet' type='text/css'>

 


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="../index.html" class="fa fa-home"> Notion: a PACS for researchers</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../GettingStarted/installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../GettingStarted/installation.html#running-notion">Running Notion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../GettingStarted/getting_started.html">Tutorial 1</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../GettingStarted/getting_started.html#create-a-pool">Create a Pool</a></li>
<li class="toctree-l2"><a class="reference internal" href="../GettingStarted/getting_started.html#working-with-the-pool">Working with the pool</a></li>
<li class="toctree-l2"><a class="reference internal" href="../GettingStarted/getting_started.html#sending-images-to-the-pool">Sending images to the Pool</a></li>
<li class="toctree-l2"><a class="reference internal" href="../GettingStarted/getting_started.html#next-steps">Next steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../GettingStarted/anonymization.html">Tutorial 2</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../GettingStarted/anonymization.html#anonymization">Anonymization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../GettingStarted/anonymization.html#anonymize-images">Anonymize Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../GettingStarted/anonymization.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../GettingStarted/moving_images.html">Tutorial 3</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../GettingStarted/moving_images.html#moving-images">Moving images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../GettingStarted/moving_images.html#create-a-second-pool">Create a second Pool</a></li>
<li class="toctree-l2"><a class="reference internal" href="../GettingStarted/moving_images.html#create-anonymization-rules">Create Anonymization Rules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../GettingStarted/moving_images.html#setting-lookup-values">Setting Lookup Values</a></li>
<li class="toctree-l2"><a class="reference internal" href="../GettingStarted/moving_images.html#id1">Moving Images</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../GettingStarted/use_cases.html">Use Cases</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../GettingStarted/use_cases.html#multi-researcher-multi-pool">Multi-Researcher / Multi-Pool</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Reference Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#notion-concepts">Notion Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dicom-configuration">DICOM Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#rest">REST</a></li>
<li class="toctree-l2"><a class="reference internal" href="#webapp">Webapp</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Development/development.html">Development</a></li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Notion: a PACS for researchers</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
    <li>Reference Guide</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="reference-guide">
<h1>Reference Guide<a class="headerlink" href="#reference-guide" title="Permalink to this headline">¶</a></h1>
<div class="section" id="notion-concepts">
<span id="concepts"></span><h2>Notion Concepts<a class="headerlink" href="#notion-concepts" title="Permalink to this headline">¶</a></h2>
<div class="section" id="pool">
<span id="pools"></span><span id="id1"></span><h3>Pool<a class="headerlink" href="#pool" title="Permalink to this headline">¶</a></h3>
<p>A Pool is a collection of DICOM images, anonymization rules and Devices to manage access.</p>
</div>
<div class="section" id="device">
<span id="devices"></span><span id="id2"></span><h3>Device<a class="headerlink" href="#device" title="Permalink to this headline">¶</a></h3>
<p>A Device consists of a descriptive name, <a class="reference external" href="https://www.dabsoft.ch/dicom/8/C.1/">Application Entity Title</a> (which must be unique for the Pool, and is abbreviated AETitle), Hostname, Port and a freetext Description.  The AETitle is used to restrict access to images using DICOM protocols.  The AETitle and Hostname must match incoming DICOM connections to the Pool to allow access.  Both AETitle and Hostname are matched using Java&#8217;s regular expressions.  For instance <tt class="docutils literal"><span class="pre">.*</span></tt> matches any entry.</p>
</div>
<div class="section" id="anonymization">
<span id="id3"></span><h3>Anonymization<a class="headerlink" href="#anonymization" title="Permalink to this headline">¶</a></h3>
<p>Anonymization is handled in two stages.  Each incoming image is processed separately by the two stages.  First, an instance of the <a class="reference external" href="http://mircwiki.rsna.org/index.php?title=The_CTP_DICOM_Anonymizer">CTP DICOM anonymizer</a> processes images first according to its configuration file that is editable via the web app (see <a class="reference internal" href="../GettingStarted/anonymization.html#anonymizationintro"><em>Anonymization</em></a> for details).  The second stage is a series of custom <a class="reference external" href="http://en.wikipedia.org/wiki/JavaScript">Javascript</a> commands that are run on specific tags.  The Javascript has access to a custom map called <tt class="docutils literal"><span class="pre">tags</span></tt> that contains the original tags of the incoming image.  Javascript also has access to an object (<tt class="docutils literal"><span class="pre">anonymization</span></tt>) containing several useful methods for anonymization.  The methods are:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">debug(text)</span> <span class="pre">/</span> <span class="pre">info(text)</span> <span class="pre">/</span> <span class="pre">warn(text)</span> <span class="pre">/</span> <span class="pre">error(text)</span></tt></dt>
<dd>Print a debug / info / warn / error message to the log</dd>
<dt><tt class="docutils literal"><span class="pre">hash(text,[length])</span></tt></dt>
<dd>Return a string containing the first <tt class="docutils literal"><span class="pre">length</span></tt> digits of the MD5 hash of <tt class="docutils literal"><span class="pre">text</span></tt> (default length is all characters)</dd>
<dt><tt class="docutils literal"><span class="pre">setValue(Type,Key,Value)</span></tt></dt>
<dd>Store a <tt class="docutils literal"><span class="pre">Value</span></tt> for later <tt class="docutils literal"><span class="pre">lookup</span></tt>.  <tt class="docutils literal"><span class="pre">Value</span></tt> is indexed by <tt class="docutils literal"><span class="pre">Type</span></tt> and <tt class="docutils literal"><span class="pre">Key</span></tt>.  The previous <tt class="docutils literal"><span class="pre">Value</span></tt> is overwritten by this method</dd>
<dt><tt class="docutils literal"><span class="pre">lookup(Type,Key)</span></tt></dt>
<dd>Lookup and return a value indexed by <tt class="docutils literal"><span class="pre">Type</span></tt> and <tt class="docutils literal"><span class="pre">Key</span></tt>.  If the value does not exist, <tt class="docutils literal"><span class="pre">lookup</span></tt> returns null</dd>
<dt><tt class="docutils literal"><span class="pre">sequenceNumber(Type,Key)</span></tt></dt>
<dd>First lookup the sequence number indexed by <tt class="docutils literal"><span class="pre">Type</span></tt> and <tt class="docutils literal"><span class="pre">Value</span></tt>.  If it does not exist, generate a unique number by incrementing the <tt class="docutils literal"><span class="pre">Type</span></tt> sequence.  For instance the first time <tt class="docutils literal"><span class="pre">anonymizer.sequenceNumber('PatientName',</span> <span class="pre">'Jones')</span></tt> is called, the return value is the string <tt class="docutils literal"><span class="pre">'1'</span></tt>.  On the second call, <tt class="docutils literal"><span class="pre">anonymizer.sequenceNumber('PatientName',</span> <span class="pre">'Jones')</span></tt> also returns the string <tt class="docutils literal"><span class="pre">'1'</span></tt>, however <tt class="docutils literal"><span class="pre">anonymizer.sequenceNumber('PatientName',</span> <span class="pre">'Smith')</span></tt> returns the string <tt class="docutils literal"><span class="pre">'2'</span></tt>.  Sequence numbers are used to generate <tt class="docutils literal"><span class="pre">PatientName</span></tt> and <tt class="docutils literal"><span class="pre">PatientID</span></tt> tags if particular identifiers are not required.  <em>NB:</em> see the <a class="reference internal" href="#anonymization"><em>anonymizer reference</em></a> for details on prepopulating the lookup tables.</dd>
<dt><tt class="docutils literal"><span class="pre">Exception(text)</span></tt></dt>
<dd>Throw an exception, immediately stopping any further processing of this image.  Exceptions can be used to reject images that do not have proper lookup information.  See <a class="reference internal" href="../GettingStarted/moving_images.html#patientnameanonymizer"><em>PatientName</em></a> for an example.</dd>
</dl>
<p>The <a class="reference internal" href="../GettingStarted/anonymization.html#anonymizationintro"><em>anonymization tutorial</em></a> contains more details.</p>
</div>
</div>
<div class="section" id="dicom-configuration">
<span id="dicomconfig"></span><h2>DICOM Configuration<a class="headerlink" href="#dicom-configuration" title="Permalink to this headline">¶</a></h2>
<p>Notion&#8217;s DICOM listener supports <tt class="docutils literal"><span class="pre">C-ECHO</span></tt>, <tt class="docutils literal"><span class="pre">C-FIND</span></tt>, <tt class="docutils literal"><span class="pre">C-STORE</span></tt> and <tt class="docutils literal"><span class="pre">C-MOVE</span></tt>.  The listening port is specified by the command line argument <tt class="docutils literal"><span class="pre">--port</span></tt> (see <a class="reference internal" href="../GettingStarted/installation.html#cli"><em>Command line options</em></a>) and is 11117 by default.  All other DICOM configuration is by Pools and Devices.</p>
</div>
<div class="section" id="rest">
<span id="id4"></span><h2>REST<a class="headerlink" href="#rest" title="Permalink to this headline">¶</a></h2>
<p>All Notion functions are available through a <a class="reference external" href="http://en.wikipedia.org/wiki/REST">REST interface</a> available on port 11118 by default and can be changed using the <tt class="docutils literal"><span class="pre">--rest</span></tt> argument in the <a class="reference internal" href="../GettingStarted/installation.html#cli"><em>command line</em></a>.</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="9%" />
<col width="64%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">URL</th>
<th class="head">Method</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>/rest/pool</td>
<td>GET</td>
<td>Get a list of all pools as json</td>
</tr>
<tr class="row-odd"><td>/rest/pool/</td>
<td>POST</td>
<td>Create a new Pool</td>
</tr>
<tr class="row-even"><td>/rest/pool/:id</td>
<td>GET</td>
<td>Get details of a pool identified by <tt class="docutils literal"><span class="pre">:id</span></tt></td>
</tr>
<tr class="row-odd"><td>/rest/pool/:id</td>
<td>PUT</td>
<td>Update a Pool, NB: AETitle is read only!</td>
</tr>
<tr class="row-even"><td>/rest/pool/:id</td>
<td>DELETE</td>
<td>Deletes a Pool and all data contained in the Pool, use with caution!</td>
</tr>
<tr class="row-odd"><td>/rest/pool/:id/move</td>
<td>PUT</td>
<td>Move studies internally between Pools</td>
</tr>
<tr class="row-even"><td>/rest/pool/:id/ctp</td>
<td>GET</td>
<td>Get the CTP configuration for this pool</td>
</tr>
<tr class="row-odd"><td>/rest/pool/:id/ctp</td>
<td>PUT</td>
<td>Update the CTP configuration for this pool</td>
</tr>
<tr class="row-even"><td>/rest/pool/:id/statistics</td>
<td>GET</td>
<td>Get statistics for this Pool</td>
</tr>
<tr class="row-odd"><td>/rest/pool/:id/device</td>
<td>GET</td>
<td>Get list of Devices for this Pool</td>
</tr>
<tr class="row-even"><td>/rest/pool/:id/studies</td>
<td>GET</td>
<td>Get list of Studies for this Pool</td>
</tr>
<tr class="row-odd"><td>/rest/pool/:id/lookup</td>
<td>GET</td>
<td>Get list of Lookups for this Pool</td>
</tr>
<tr class="row-even"><td>/rest/pool/:id/script</td>
<td>GET</td>
<td>Get list of Anonymization scripts for this Pool</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="webapp">
<span id="id5"></span><h2>Webapp<a class="headerlink" href="#webapp" title="Permalink to this headline">¶</a></h2>
<p>In addition to the REST interface, an <a class="reference external" href="http://emberjs.com/">Ember.js</a> single page web application is avaliable on the same port as the REST interface.  By default it is <a class="reference external" href="http://localhost:11118/index.html">http://localhost:11118/index.html</a> but the port may be changed using the <tt class="docutils literal"><span class="pre">--rest</span></tt> argument on the command line.</p>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../Development/development.html" class="btn btn-neutral float-right" title="Development">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../GettingStarted/use_cases.html" class="btn btn-neutral" title="Use Cases"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2013, William Ryan, Patricio Fajnwaks, Daniel Blezek, Steve Langer, Brad Erickson.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>