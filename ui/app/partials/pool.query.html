<div>
  <div class="panel panel-default">
    <div class="panel-heading">
      <h2 class="panel-title">Query {{model.name}}</h3>
      </div>
      <div class="panel-body">
        <b>Name:</b> {{model.name}}<p/>
        <b>Application Entity Title:</b> {{model.applicationEntityTitle}}<p/>
        <b>Description:</b> {{model.description}}<p/>
      </div>
    </div>

    <div class="panel panel-default" ng-hide="query">
      <div class="panel-heading">
        <h2 class="panel-title">Query</h3>
        </div>

        <div class="panel-body">
          <form role="form" enctype="multipart/form-data" >
            <div class="form-group">
              <label>DICOM Destination to Query</label>
              <select ng-model="connectorKey" ng-options="c.connectorKey as c.name for c in connectors " name='connectorKey'></select>
            </div>

            <div class="form-group">
              <label>File input</label>
              <input type="file" name="file" id="queryFile">
              <p class="help-block">Upload an Excel or CSV file using the templates (Excel / CSV).</p>
            </div>
            <button ng-click="submit()" class="btn btn-default">Submit</button>
          </form>
        </div>
      </div>

      <div class="panel panel-default" ng-hide="!query">
        <div class="panel-heading">
          <h2 class="panel-title">Query Result <i class="fa fa-refresh" ng-click="refresh()"></i></h3>
          </div>
          <div class="panel-body">
            <b>Status:</b> {{query.get('status')}}<p/>
            <b>DICOM Server:</b> {{query.get('device').applicationEntityTitle}}@{{query.get('device').hostName}}:{{query.get('device').port}}<p/>
            <button ng-disabled="query.get('status') != 'Query Completed'" ng-click="fetch()" class="btn btn-default">Fetch Studies</button>
            <button ng-click="reset()" class="btn btn-default">Reset Query</button>
            <table class="table table-striped table-hover table-condensed">
              <thead>
                <tr>
                  <td></td>
                  <td>ID</td>
                  <td>Name</td>
                </tr>
              </thead>
              <tbody ng-repeat="item in query.get('items')">
                <tr>
                  <td><i class="fa fa-check-square-o" ng-click="fetchAll(item)"></i></td>
                  <td>{{item.patientID || "N/A"}}</td>
                  <td>{{item.patientName || "N/A"}}</td>
                  <td>{{item.status}}</td>
                </tr>
                <tr>
                  <td></td>
                  <td colspan="3">
                    <table class="table table-striped table-hover table-condensed">
                      <thead>
                        <tr>
                          <td>Fetch</td>
                          <td>Patient Name</td>
                          <td>Patient ID</td>
                          <td>Accession Number</td>
                          <td>Study Date</td>
                          <td>Modality</td>
                          <td>Description</td>
                          <td>Status</td>
                        </td>
                      </thead>
                      <tbody >
                        <tr ng-repeat="result in item.items" ng-class="{ 'success' : result.status.startsWith('success') || result.status.startsWith('completed'), 'warning' : result.status.startsWith('fail') }">
                          <td><input type="checkbox" ng-checked="result.doFetch" ng-click="toggleFetch(result)"></td>
                          <td>{{result.patientName}}</td>
                          <td>{{result.patientID}}</td>
                          <td>{{result.accessionNumber}}</td>
                          <td>{{result.studyDate}}</td>
                          <td>{{result.modalitiesInStudy}}</td>
                          <td>{{result.studyDescription}}</td>
                          <td>{{result.status}}</td>
                        </tr>
                      </tbody>
                    </table>
                  </td>
                </tbody>
              </table>
            </div>



          </div>


        </div>


      </div>
