<div>
  <div class="panel panel-default">
    <div class="panel-heading">
      <h2 class="panel-title">Query {{model.name}}</h3>
    </div>
    <div class="panel-body">
      <b>Name:</b> {{model.name}}<p/>
      <b>Application Entity Title:</b> {{model.applicationEntityTitle}}<p/>
      <b>Description:</b> {{model.description}}<p/>
      <b>Anonymize?</b> {{model.anonymize}}<p />
    </div>
  </div>

  <div class="panel panel-default" ng-hide="query">
    <div class="panel-heading">
      <h2 class="panel-title">Query</h3>
    </div>

    <div class="panel-body">
      <form role="form" enctype="multipart/form-data" >
        <div class="form-group">
          <label>DICOM Destination to Query</label>
          <select ng-model="queryDevice" ng-options="d.deviceKey as d.hostName for d in devices " name='deviceKey'></select>
        </div>
        <div class="form-group">
          <label>Receiving Pool</label>
          <select ng-model="receivingPool" ng-options="p.poolKey as p.name for p in pools" name='destinationPoolKey'></select>
        </div>
        <div class="form-group">
          <label>File input</label>
          <input type="file" name="file" id="queryFile">
          <p class="help-block">Upload an Excel or CSV file using the templates (Excel / CSV).</p>
        </div>
        <button ng-click="submit()" class="btn btn-default">Submit</button>
      </form>
    </div>    
  </div>

  <div class="panel panel-default" ng-hide="!query">
    <div class="panel-heading">
      <h2 class="panel-title">Query Result <i class="fa fa-refresh" ng-click="refresh()"></i></h3>
    </div>
    <div class="panel-body">
      <b>Status:</b> {{query.status}}<p/>
      <b>DICOM Server:</b> {{query.device.applicationEntityTitle}}@{{query.device.hostName}}:{{query.device.port}}<p/>
      <button ng-click="fetch()" class="btn btn-default">Fetch Studies</button>
      <table class="table table-striped table-hover table-condensed">
        <thead>
          <tr>
            <td></td>
            <td>ID</td>
            <td>Name</td>
          </tr>
        </thead>
        <tbody ng-repeat="item in query.items">
          <tr>
            <td><input type="checkbox" ng-checked="item.doFetch" ng-click="fetchAll(item)"></td>
            <td>{{item.patientID}}</td>
            <td>{{item.patientName}}</td>
          </tr>
          <tr>
            <td></td>
            <td colspan="2">
              <table class="table table-striped table-hover table-condensed">
                <thead>
                  <tr>
                    <td>Fetch</td>
                    <td>Accession Number</td>
                    <td>Study Date</td>
                    <td>Modality</td>
                    <td>Description</td>
                  </td>
                </thead>
                <tbody >
                  <tr ng-repeat="result in item.items" ng-class="{ 'success' : result.status == 'success', 'warning' : result.status == 'fail' }">
                    <td><input type="checkbox" ng-checked="result.doFetch" ng-click="toggleFetch(result)"></td>
                    <td>{{result.accessionNumber}}</td>
                    <td>{{result.studyDate}}</td>
                    <td>{{result.modalitiesInStudy}}</td>
                    <td>{{result.studyDescription}}</td>
                  </tr>
                </tbody>
              </table>
            </td>
        </tbody>
      </table>
    </div>



    </div>


  </div>


</div>